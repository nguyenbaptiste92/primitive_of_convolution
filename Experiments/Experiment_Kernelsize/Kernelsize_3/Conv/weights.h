#include "nnom.h"

#define CONV2D_KERNEL_0 {57, -9, -49, -65, 47, 19, 15, -61, 71, -64, 39, 34, -60, 34, -2, -36, 18, -52, -61, 42, 3, -42, -50, 10, -27, -23, 54, -55, 68, 11, 67, 23, -33, 59, 54, -37, 23, -34, 59, -39, -3, 13, -14, 12, 70, -43, -18, 36, 68, -12, 59, -60, 20, -51, -2, 32, -23, -38, -68, -49, -9, 57, 24, -73, 15, 63, -68, 13, -59, -46, -49, -44, -41, -51, 73, 46, -9, -2, 67, -2, -29, 3, 27, -13, 21, -53, -67, 6, 56, -26, 18, 66, -30, -67, -15, -18, 45, -20, -56, -57, 57, -38, 39, 36, 68, 22, -68, 59, 12, -70, -73, -69, -12, 30, -58, 14, -54, -29, 6, 64, 1, 22, 17, 62, 13, 0, -53, -39, -20, -44, -13, 9, -15, -39, 63, 66, 48, -33, 47, 24, -69, -3, 34, 34, 9, 50, 38, 33, -71, -66, 38, -52, 60, -57, 62, 3, 9, -20, -57, -61, 29, 72, 26, 64, -4, 52, 7, -26, 50, 52, 40, -37, 20, -16, -25, -66, -58, -53, -54, -39, -69, -25, -25, -53, -8, 50, -15, 38, 58, 45, -48, 51, 30, 7, -26, -2, 73, 18, 49, -72, 6, -20, 47, 16, 26, 19, -41, 19, -32, 54, -63, -22, -9, 71, 8, 59, -65, 49, -51, 32, -46, 24, 18, 15, 4, -65, 34, 72, 31, -67, 4, -58, 49, -66, -7, 41, -8, -17, -66, 65, -65, -41, -13, 11, -30, -6, -69, -52, -51, 27, 19, 66, -20, -28, -52, -17, 62, 60, -18, 33, -17, 42, 69, -44, 31, -21, -66, 12, -26, 47, 52, 23, -7, 67, -28, -33, -48, 11, 29, -68, 46, -51, 51, 58, 48, 2, -3, -57, 4, 15, -55, 37, -7, 46, 62, -14, -31, -42, -22, 64, 68, 46, 31, 41, -33, -58, -8, -14, 56, -54, -20, 26, -7, -25, 7, 27, -3, -43, -6, -14, -11, 31, -51, 5, -4, 55, -10, 43, 63, -66, -53, 0, 56, -55, 22, -28, -48, -57, -42, 20, 38, 24, -44, 66, 5, 37, 38, 21, 36, -20, -56, 33, 48, 37, 58, -23, 48, -52, 64, -6, 63, 0, -61, -35, -22, -44, 6, 56, 43, 66, -64, 50, -17, 47, 11, 0, 28, 39, 31, -67, 35, 58, 0, -52, -61, -61, -53, 21, -56, 33, 73, -10, 26, 44, 46, -19, 59, -25, -28, -54, -46, -33, -18, 45, -37, 58, 22, 32, 48, 0, -46, 46, 51, 10, -71, -65, -57, -50, 10, -67, -34, 6, 14, -34, -31, 24, -3, -71, -69, -63, -3, 20, -55, -13, -8, -21, 74, -25, -6, 54, -69, 21, 43, 23, -36, 8, -7, 66, 49, -30, -43, 46, 29, 70, 37, 0, 37, -45, -25, 22, 50, -25, 46, -31, -10, -64, -4, -23, -23, -9, -1, -41, -51, -12, -1, 3, -37, 8, -7, 38, 46, 25, 62, 40, 40, 23, 57, -39, 39, 19, 52, 7, -57, 28, -63, -19, -39, 41, 40, 29, -21, -26, 13, 26, 13, -65, 2, 67, -66, -25, 34, -45, 60, 4, -60, -74, 46, -19, 52, 37, -29, -61, 51, -31, 14, 56, -31, -70, 69, -41, -24, 36, 45, 15, -74, -60, 47, 27, 67, 9, -57, -65, -56, -57, -65, -63, 68, 67, 33, 29, 1, -10, -21, -57, -66, -69, -1, -54, -61, 23, -48, 44, 52, -68, 25, -71, 72, 8, 49, 43, -64, 42, -41, -69, 70, 41, 47, 70, 45, -11, -65, 10, 8, -56, -51, 31, -52, 74, 29, -26, 18, 23, 31, 74, -52, -49, -64, 0, -4, -22, -21, -68, 4, 35, -43, 59, -23, 67, -47, 48, -4, -28, 56, -7, 44, 62, -41, -68, -67, -27, -70, 38, -10, 62, -35, 33, 67, -44, -42, 19, 52, -22, -56, -60, 65, -56, 64, -62, -43, -31, 18, 19, 50, 33, 9, -30, 37, -7, -1, -42, -31, 41, -44, -13, 39, -42, 7, 25, 21, 1, 68, 28, -3, 35, -47, -51, -52, -51, 43, -59, -7, -55, 0, 1, 39, 9, -68, 10, 63, 63, 12, -35, -70, 62, 3, 44, -31, 38, -63, -12, -29, 54, -10, 6, 14, -60, 7, 1, -31, 5, -57, -16, 32, 60, 29, 66, -43, 45, 30, -22, 25, 15, 6, 20, 59, 59, -26, 35, -37, -30, 59, -57, 41, -66, 65, -53, 69, 3, 41, 38, 12, -61, 61, 6, -17, -14, -28, 62, -6, 27, -56, -13, -14, -46, 50, 43, -54, 56, 38, -27, -21, -22, -36, 15, 24, -6, -22, -30, 40, 42, 51, -72, -49, -38, 43, -12, 44, -16, 52, -67, 43, -48, -67, -16, -70, -58, -52, 69, -4, -64, 51, -3, -60, -28, -55, 8, -12, -69, -16, -40, 39, -20, 65, 26, 9, -40, -53, 47, -58, -16, 42, 21, -7, -33, -4, -34, -66, -25, 69, -12, 15, -6, -8, -42, 8, 51, 51, -61, -20, 29, -65, 28, -63, 59, -23, -52, 33, -20, 23, -64, 20, -43, -65, 3, -45, -13, 64, -51, 39, 56, 25, -69, 0, -54, -68, 47, -5, -6, 59, -22, 19, -37, 62, -65, -34, -22, 15, 37, -42, 30, 65, -46, 29, 49, 54, -29, 46, -28, 42, 46, 8, 18, -1, -38, -9, -57, -43, 7, -27, 5, -28, 16, -48, -70, -30, 50, 9, -39, 31, -10, -43, 52, 52, -12, 71, 51, -68, -33, 64, 48, 63, 27, -63, -42, -61, -29, 19, 64, 9, 62, -69, 36, -19, -39, -64, 6, -27, -3, 13, 10, -15, 46, 56, -1, -69, -38, 65, 33, 16, -51, -56, -17, -15, 56, -55, 51, 26, 4, 42, -70, -9, 25, 0, -34, -72, 37, -59, 65, -63, -19, 67, -58, -14, 65, -59, 5, 46, 33, 47, 51, 64, 38, -70, -29, 13, 50, -68, -44, 28, -56, -59, -39, -40, 32, -29, -2, -61, -64, -13, 41, 3, -69, 11, -2, -10, 32, -70, 10, -18, -61, -19, 34, -1, -60, 49, 27, 42, 59, 19, -57, -50, -58, 23, 20, -15, 26, -33, -23, -9, 12, 10, 21, 44, 42, 45, 47, 25, 50, -59, 44, 60, -38, 14, -21, 30, -63, 25, -32, -38, -13, -29, 38, -44, 64, 11, -26, -60, 53, -57, -41, 57, -20, 69, 48, -24, -32, 62, -11, -61, 74, 4, -8, -59, 66, -62, -34, 12, 17, 1, -60, 49, -50, -68, 63, 24, -6, -10, -18, -1, -48, 16, 40, -24, -65, -59, -23, 23, -10, 19, -16, -32, -43, 61, -54, 18, -24, -37, -73, -42, 37, -39, -41, -47, 44, 46, -35, -6, -69, -68, -44, -39, 29, -12, 40, 34, 50, -36, 71, 9, -37, 43, 57, 56, 46, 25, 14, -64, -51, 29, -47, -38, -11, 30, 51, -9, -43, 27, -55, 9, -67, 64, 37, -36, 26, 29, -20, 42, 7, -4, -66, -53, -62, 42, -30, -31, 7, -5, -6, 69, 22, -15, -21, 5, 68, 61, 35, 27, -34, -64, 21, 68, 65, 27, 47, -55, -64, 47, -38, -70, -68, -55, 14, 23, 47, 65, 54, -66, 42, -56, 18, -43, 34, 69, 27, 55, 48, 42, -50, -18, 40, -21, 33, -36, 9, -2, 21, -58, 21, 55, -14, -22, 5, -62, -51, -57, 60, 39, -61, 64, 38, -45, -68, 42, 35, -34, -59, -69, -13, -52, -49, -40, 58, 13, 29, -65, 39, 11, 12, -73, -18, -47, -49, -1, -59, 34, -13, 32, 41, -46, -44, -74, 67, 50, -15, 41, -26, -70, 30, -49, -59, -39, 21, -62, 35, -33, -74, 60, -49, -37, -9, -59, 13, -45, 11, 37, 44, 59, 2, 11, 44, -35, 28, -73, 27, 24, -49, -33, 63, 14, -73, -22, -51, -55, 12, 11, -73, -63, 16, -53, -35, 33, 59, 28, 65, 30, 5, -16, 45, -19, 53, 51, 45, -42, 2, 13, 56, -11, -44, -42, -2, -1, -52, -37, 69, 15, -69, -2, -41, -55, -10, 28, -26, 24, 30, -31, 45, -23, 15, 17, -19, -72, -47, 57, 71, -60, -19, -29, -11, 60, 71, 40, -45, -48, -7, 69, -25, 10, -66, -58, -5, -40, 12, -15, 26, 45, -31, -20, -72, 56, -15, 22, -57, 41, 42, 51, -29, 33, 45, -5, 53, 18, 50, 24, 16, 24, 69, 42, 71, -42, 38, 27, 0, 50, 23, 8, 16, 33, 6, 29, 71, 43, 65, 35, 27, -44, -11, 31, 44, -18, -29, -21, 34, 6, 18, 20, -5, 9, 51, -66, 7, 32, 42, -67, 53, 22, -4, -4, 3, 5, 13, -58, 51, 24, 7, -51, -19, 63, 65, 28, -34, -22, 28, -44, -58, -30, -18, -33, -50, -59, 15, 30, -5, -73, -14, 10, 11, -6, -33, -39, -69, -58, -70, -72, 13, 51, 26, 68, 55, 24, -61, -15, 4, 51, -62, -58, -3, -46, 72, -57, 56, -28, -69, -20, -53, -63, 50, 40, 9, -17, -21, 65, 32, -26, -21, -60, -58, 22, -2, -61, 15, 46, -25, -65, -6, 0, 38, -57, -18, -32, 40, -58, 9, 53, 61, 66, -29, 23, -14, -58, 28, 72, 54, -24, 38, -58, 27, 20, -61, -18, 33, -61, -19, 11, -73, 36, 4, 55, 35, 32, 41, -45, -23, 24, -30, -61, 39, 38, 0, -1, 2, -19, -18, 47, 7, -46, 54, 26, -8, 61, 69, 33, -63, -57, 66, -73, -38, -24, 15, -12, -7, 15, 48, 64, 17, -51, -45, -51, -48, -67, 8, 59, -18, -69, 66, -61, 14, 17, -72, 7, 30, -68, -21, 21, -42, -6, -64, 2, 50, -30, 55, 55, 5, -13, 26, -14, -71, 30, 26, -34, -17, 37, -34, 20, 74, 3, 38, 31, -12, 16, 51, 44, -6, -33, 5, -40, -3, -27, -52, -1, -60, -1, -49, -24, 71, 27, 72, -61, -6, -57, -16, 61, -54, 25, 66, -28, 30, -4, 61, -72, 9, -12, -72, -64, 48, -50, -54, 39, 70, 65, -54, 67, -64, -57, -53, -31, 20, -38, 8, -55, 14, -55, 42, -13, -66, -16, -44, -16, 14, 53, -29, -13, -16, 43, -57, 18, 23, 37, -62, 65, -28, -53, -44, 14, -51, 28, -12, 72, -50, -10, 19, 18, -48, 18, 2, -23, -9, -71, -55, -43, -50, -39, 42, -36, 53, 53, 44, -59, -16, 22, -54, 57, -54, -69, 3, -40, 52, -30, -59, 61, -7, -46, 50, -39, 38, -66, -33, -54, -50, 8, -49, -34, -31, -22, 5, 48, -54, 11, -59, 61, 56, 52, -28, 15, -61, -12, -53, -60, -12, -54, 6, -46, -59, 32, -2, 24, -22, -44, -49, 37, 47, 28, -2, -68, -67, -35, 55, -17, -20, 53, -30, -8, -19, -23, -68, 1, 25, -61, 27, -28, -9, -28, -15, -11, -48, -64, -50, 46, 25, 10, -55, 56, -10, 68, 3, -20, 18, 19, -69, 18, -67, 67, -41, 66, -10, 70, -47, -53, -40, -30, -40, -31, -45, -32, 40, -39, -60, 47, 59, -19, -74, 0, 34, 71, -66, 36, 40, -32, -57, -18, -63, 8, 16, -37, -46, 46, -65, -30, -63, -56, 51, -18, -24, 10, 54, 52, -66, 67, -59, -21, 57, -49, -42, -55, -11, -49, 49, 33, 24, -21, -49, 26, 66, -50, 59, 48, 20, -59, 29, -29, 46, -12, -51, 42, 45, 28, 51, 49, -43, 7, 49, 54, 44, 1, 59, 61, -13, 58, 43, 10, 3, -47, 7, 54, -7, 15, -55, 73, 7, -13, -69, -30, -4, 40, 48, -73, -19, -66, -47, 28, 20, 12, -23, 22, 17, -20, -2, 68, -51, 29, 29, -62, -63, 37, -4, -52, -69, -34, -26, 63, 7, 43, -20, 23, -15, 30, -57, -51, -9, -63, 63, -61, -21, 39, 56, 7, -34, 68, -2, -22, 6, 15, 37, -64, -28, -1, 70, -40, 57, -63, -37, 28, -34, 49, 38, -74, 61, 64, 72, -72, -40, 10, 53, 62, 34, -40, 64, -27, 42, -36, 57, -3, -31, -49, -12, 29, 25, 72, -32, 17, 30, -43, 14, -72, -48, -38, -31, -49, 16, 17, 39, -3, -16, 35, -44, 33, -57, -34, 31, -51, 41, -53, 33, 32, -36, -1, -44, 18, -67, -51, -60, 1, 5, -49, 47, -30, 10, 51, 31, -4, 29, -10, -40, -20, -25, 71, -27, -67, -29, -35, 38, 37, -30, 44, 13, 69, -5, 22, 64, 42, -15, -41, -3, -3, 17, -17, 19, -39, -2, -48, 4, -18, -39, -4, -65, 62, -10, 14, -2, -19, -17, 2, 8, 35, 14, -71, -72, 22, 50, 59, 6, 62, 13, 17, 73, -41, 34, 23, 15, -30, 41, -34, 46, -1, 46, -35, -70, 60, 28, -50, 7, -19, -45, 10, 62, 1, -57, 3, 51, -11, -30, -5, -30, 31, -6, -61, 28, 20, -35, 39, -50, -32, 57, -61, -5, 11, -8, -28, -72, 8, 18, -53, 1, 32, -8, -47, -16, -8, -49, -68, 28, 14, -49, 7, -62, -24, 47, -5, 0, -48, 2, 51, 36, -22, 72, 53, -37, 32, -22, -57, -72, 23, 47, 54, -54, -19, 26, 14, 72, 47, 27, 28, 26, 34, 36, -5, -21, -34, -31, -20, 38, 12, -73, -29, -32, -48, 44, 19, -47, 9, 13, 15, -58, 39, 16, 63, -6, -12, 15, -69, -69, 53, 54, -30, 4, 5, 36, -45, 58, -48, 6, -72, -33, 52, -39, -61, -73, -65, 10, -45, -69, 8, -55, 67, 51, -65, -37, -53, -56, 54, -21, -61, -8, 38, 33, 54, -62, -9, 51, 34, 74, -27, -24, -56, 41, -52, -57, 24, 3, 2, -36, -18, -1, 38, 57, 68, -57, -30, -57, 14, 72, 30, 41, 3, 42, -70, 37, 61, 41, 62, 27, 31, -62, -46, -8, -47, -55, -56, 40, -1, 8, -70, -71, -61, 39, 35, 57, 45, -26, 69, -45, 19, -62, 21, -30, 66, -10, 59, 57, 63, -27, 59, -74, 56, 71}

#define CONV2D_KERNEL_0_SHIFT (9)

#define CONV2D_BIAS_0 {12, 106, -7, 3, -92, -64, -6, -91, 45, -94, -109, 78, 61, -92, 29, -83}

#define CONV2D_BIAS_0_SHIFT (8)


/* output enconding for each layer */
#define INPUT_1_OUTPUT_SHIFT 7
#define CONV2D_OUTPUT_SHIFT 5

/* bias shift and output shift for each layer */
#define CONV2D_OUTPUT_RSHIFT (INPUT_1_OUTPUT_SHIFT+CONV2D_KERNEL_0_SHIFT-CONV2D_OUTPUT_SHIFT)
#define CONV2D_BIAS_LSHIFT   (INPUT_1_OUTPUT_SHIFT+CONV2D_KERNEL_0_SHIFT-CONV2D_BIAS_0_SHIFT)
#if CONV2D_OUTPUT_RSHIFT < 0
#error CONV2D_OUTPUT_RSHIFT must be bigger than 0
#endif
#if CONV2D_BIAS_LSHIFT < 0
#error CONV2D_BIAS_LSHIFT must be bigger than 0
#endif

/* weights for each layer */
static const int8_t conv2d_weights[] = CONV2D_KERNEL_0;
static const nnom_weight_t conv2d_w = { (const void*)conv2d_weights, CONV2D_OUTPUT_RSHIFT};
static const int8_t conv2d_bias[] = CONV2D_BIAS_0;
static const nnom_bias_t conv2d_b = { (const void*)conv2d_bias, CONV2D_BIAS_LSHIFT};

/* nnom model */
static int8_t nnom_input_data[16384];
static int8_t nnom_output_data[16384];
static nnom_model_t* nnom_model_create(void)
{
	static nnom_model_t model;
	nnom_layer_t* layer[3];

	new_model(&model);

	layer[0] = Input(shape(32, 32, 16), nnom_input_data);
	layer[1] = model.hook(Conv2D(16, kernel(3, 3), stride(1, 1), dilation(1, 1), PADDING_SAME, &conv2d_w, &conv2d_b), layer[0]);
	layer[2] = model.hook(Output(shape(32, 32, 16), nnom_output_data), layer[1]);
	model_compile(&model, layer[0], layer[2]);
	return &model;
}
