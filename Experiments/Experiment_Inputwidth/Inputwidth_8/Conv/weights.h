#include "nnom.h"

#define CONV2D_KERNEL_0 {-44, 37, 42, -52, 70, -66, 70, 21, -14, 14, -8, -53, -49, -64, -42, 50, -27, -12, 54, -64, -32, 59, 62, -24, -45, -33, 41, -13, 7, -3, -43, -56, 25, 44, 14, -57, -35, -14, -60, 67, 1, -8, 48, 13, -72, 62, 22, -71, 69, -67, -38, 9, -6, 37, 34, 43, -15, -5, -31, -33, 21, 63, 33, -68, 58, 14, -26, -39, 22, 5, 50, 22, 5, 22, -43, -68, -71, 56, -34, -53, -68, -13, -45, 39, 25, 29, -20, -71, 14, -31, -13, 54, 52, 49, -47, -9, 36, -43, -7, 62, -62, -37, 18, 61, -14, 13, 56, -19, 47, -33, -50, -6, -19, -27, 46, -61, -14, -42, -69, 18, 55, 47, -1, -67, 54, -59, -42, -56, 6, 6, 50, 27, -19, -21, -46, -66, -52, -1, -1, 23, 66, -49, 9, -59, 28, -31, -2, -68, -28, 18, -60, 28, -66, -18, 65, -12, -42, -37, -32, -8, -5, -69, -24, -64, 31, 26, 17, 62, 25, -57, 26, -43, -21, -43, 36, -53, 25, -18, -72, 33, 16, 24, -30, -25, -73, 34, -42, -39, -70, -23, 24, 29, -12, -15, 13, -14, 4, 7, 42, 72, 45, 74, -20, 57, 37, 57, 61, -62, 43, -56, 24, 71, 54, 67, 8, -73, 28, 73, 38, -2, -5, 56, -70, -51, -12, -71, -67, -15, -20, 71, -40, 4, -62, -33, -26, -67, -14, 13, 22, -2, -43, 3, -12, -11, -36, -56, 55, 43, -30, -63, 62, -21, -53, 56, 31, -36, 66, 20, -56, -53, 23, -56, 34, 55, -26, -24, 40, 48, -6, -16, 66, -73, 68, -35, -3, 15, 43, -55, 14, 3, -70, 44, 25, -4, -11, -66, 11, -54, -59, -37, -69, -65, -31, 61, 35, 6, -39, 13, 74, 27, -15, 71, 1, 53, -5, -35, -42, -46, 23, -44, 50, 3, 23, 8, 12, -68, -60, 21, 9, 45, -51, 55, -58, 17, 61, 10, -39, 31, -33, 9, -16, 12, -20, 11, 0, -9, 19, -31, -3, -62, 72, 72, 27, -60, 5, 24, -42, -19, 56, 5, -47, 54, -53, -10, -61, 51, -74, -24, 27, -10, 40, 43, -7, -24, 27, 21, -51, -56, 61, 29, 10, 42, -12, 9, 66, 24, -7, -32, -6, 21, -63, -48, 23, -52, -28, 63, -4, 50, -46, 35, -68, 22, -8, 6, -32, 29, -14, -33, -4, -39, 60, 49, 62, -26, -40, -1, -21, -28, 55, -70, 6, 25, -29, -41, 68, 44, -54, -6, 61, 41, 25, -1, -6, 56, 58, 8, 33, -36, 34, 19, -9, -67, -9, 21, -37, -21, 68, 32, -53, -68, 29, 25, 46, 12, 32, 74, -53, -19, -50, -19, -4, -36, -21, 25, -1, -55, -35, 9, 30, 51, 18, 10, -27, 74, -73, 16, 20, 48, 43, -51, 16, 17, 41, -9, -25, -36, -41, -39, -25, 7, -54, 57, 52, 27, 23, -34, 41, 51, 12, -55, 3, -51, -7, -59, 13, -26, 69, -16, 64, 63, -61, -37, 27, 62, -41, 73, -6, 66, -23, -73, 2, -25, -2, 38, 63, -8, 42, 10, -1, 61, -14, 49, -72, 72, 40, -25, -67, 65, 6, 26, -55, -18, -19, -54, 67, 53, 64, 70, 35, -10, -21, 4, 38, -35, 0, 71, 17, 68, -43, 29, 73, -53, -25, 29, -51, 1, 14, 59, 74, 57, 41, 48, -15, -43, -44, 23, 10, 58, -5, 66, 32, -52, 39, -72, -2, 3, -19, 5, 68, 1, -24, -37, 5, -40, 21, 8, 23, 33, 43, 12, 54, 24, -57, -62, -72, -16, -32, 41, -69, -13, -17, 25, -67, -48, -29, 43, 55, -14, -49, -3, -64, -46, -43, -40, -58, -21, -46, -23, -23, -27, 62, -3, 14, -18, -3, 9, -65, 45, -4, 53, -71, 17, -67, -58, 21, -46, 60, 50, 61, 11, -60, 13, -1, -36, 20, 1, -62, 0, 34, -24, 14, 51, -69, 2, -25, 70, 52, -5, -9, 16, -61, 26, 2, 54, 62, 68, -1, 8, -60, -13, -6, 39, -23, 33, -8, -9, -11, 21, 43, -73, 49, 29, -70, 21, -53, -44, 62, 57, 1, 52, 40, 51, 56, -9, -56, -59, 2, -30, -10, -66, -50, 38, -13, -31, 3, -65, -35, -62, 16, -65, -49, 57, -29, -24, 28, 21, 16, -73, 46, -67, -47, -17, 8, -35, 60, -38, 70, 44, 49, 61, 63, -54, -65, 61, -51, -17, -71, 0, -48, -28, -70, 14, -9, 63, 53, 72, -63, -48, -21, 29, -11, 60, 27, -16, -13, 30, 47, 15, 63, -39, -52, 3, -61, 17, -66, -57, -45, 1, 46, -18, 8, 7, 4, -41, 11, 61, -57, 69, 56, -44, -13, 19, 62, -3, -7, 2, 60, 20, -70, -59, -20, 3, -46, 23, 29, 44, -21, 24, -59, 64, 11, -12, 52, 31, -31, 35, 47, 37, -8, 72, 45, 31, 39, -35, -54, -67, 7, 12, -22, 24, 39, 36, -8, 6, -46, 16, -39, -45, -54, 45, -20, 47, 6, 16, -9, 18, -10, 55, -42, -19, -9, -16, -32, -15, 0, 47, -63, 66, -28, 25, -19, -68, 64, 48, 38, 23, -45, 37, -36, -55, 70, -22, 32, 31, -30, -19, 25, -23, 33, 26, -73, -21, -38, 3, -59, -1, -5, 41, -43, -36, 19, -64, -49, 26, 27, 45, 2, -38, -29, -63, -9, 59, 57, -55, 62, 56, 62, 33, -50, -38, -39, 1, 46, -70, -12, -50, -26, 49, 45, 55, 57, 21, 13, -48, -3, 10, -66, -65, 62, -39, 24, 13, 29, 25, 20, 30, -66, 48, -24, -25, 1, -65, 67, 41, 28, 6, -19, 50, 61, -23, -70, 29, 62, -56, 18, 25, -53, 34, 65, 71, 43, 20, 35, -63, -40, -6, -71, -46, -52, 35, -33, -20, 54, -60, -25, -9, -34, -33, -8, 14, -58, 39, -34, -35, 51, 28, -12, 22, 10, 12, 70, 46, 0, 13, 54, -12, -73, -31, -21, 70, 53, -21, -12, 12, 53, 57, -1, -20, 19, 61, -70, 67, 22, 53, -18, 11, 19, 68, -69, -46, 44, 46, 16, 70, -18, -64, 0, -31, 21, 46, -71, -64, 62, 66, -70, -4, -28, 40, 37, 44, 66, 42, -25, 65, 33, -43, -64, 38, -59, -40, 42, 50, 52, -7, 63, -59, -19, -56, -55, -71, 31, -63, -68, -6, -25, 38, -28, 8, 52, 41, 2, -64, 1, 33, -6, -56, 70, -20, 17, -28, -20, 73, 25, -67, 54, -18, -30, 48, 71, -50, 65, -31, -69, -41, -30, 65, -59, -27, -43, 46, -63, 27, 32, -48, 26, 11, -62, 37, -64, 2, -66, -72, -74, -58, 36, -13, -22, -52, 31, 45, 53, 55, 63, -48, 2, 9, 48, -56, 12, -38, 11, 4, 49, -25, 55, -5, 48, 69, 22, 15, 24, 57, 8, 47, -56, 42, -60, 9, -35, 70, -8, 32, 2, -34, -44, 13, 67, 1, -49, -73, -36, -34, 73, 35, -19, -20, -50, 47, -30, 14, -4, -64, 71, -44, -54, 52, -12, -32, -27, 28, -36, -31, -48, 41, 31, 40, -14, 25, -56, 20, -45, -55, -37, 61, -8, 8, 34, 15, 35, -51, -65, -38, -50, -15, -29, -51, 24, -11, 6, -38, 5, -33, 16, -67, 32, 11, -21, -12, 54, 40, 35, -35, -40, -56, -54, -61, -38, 9, -5, -61, -21, 58, 57, -20, 13, -46, 43, -34, 65, -49, 15, -15, 20, -7, -66, 41, 15, 4, 37, 64, 48, -21, 25, 31, -73, 34, 57, -32, -50, -26, -54, 11, -73, -32, -6, 66, -12, -41, 9, 34, 9, 13, -40, 33, 22, 33, -10, 51, -34, -30, 38, 39, 32, -1, -47, -5, 16, 61, 11, -12, -39, -44, -22, 6, 70, -20, 71, 62, -45, -31, -73, -27, 52, -45, 62, 2, 21, -54, -70, 46, 43, 9, 67, 16, 23, -15, -51, 9, -27, 66, -55, 69, 8, -62, -10, 5, -5, 14, -42, -66, -46, -65, 4, 9, 52, -65, -32, 73, -58, 34, 50, 24, -28, 32, 47, -28, 33, 48, 66, -21, 33, -22, 66, -20, 57, 63, -9, -73, -71, -47, -16, -30, -10, -24, -20, 51, -2, 71, 66, -44, 49, -14, 29, 2, 73, -8, 5, -71, -61, -23, -23, 65, 39, 60, -72, -33, 29, 49, 33, -43, -35, 68, 49, -54, 62, -17, 16, -31, -52, 55, -23, 27, 30, -10, -60, -61, -59, -30, -55, -33, -22, 51, 14, 37, -36, 73, 60, 12, 68, 10, 4, 72, 47, 7, -33, 34, -69, -55, 51, -65, 5, -3, -30, -9, 12, -51, 44, 44, -51, -2, 3, 29, 28, 59, 37, -37, 50, -54, -8, 63, 61, 55, 32, 17, 23, -58, 29, -70, -46, 11, -55, 11, -73, 5, -60, -4, 50, 57, -5, 8, 68, 16, -58, -25, 7, -55, 27, 14, -11, 30, 29, 38, 13, -29, -24, -68, -70, -49, 38, -20, -2, -11, 65, 4, 32, 53, 23, -10, 39, -6, 52, 64, 18, -8, -17, -38, -55, -60, -4, -53, -12, -19, -30, -21, 30, -35, 32, -23, -56, 68, 68, -6, -71, 43, -38, -1, 59, -40, -24, 38, 8, -26, 65, 43, 19, -15, 9, -68, -34, 26, 50, -34, 64, -16, 65, -45, -38, -30, 43, -37, -58, 56, 26, 4, 4, 10, 37, 23, -14, -46, -47, -44, 52, -40, -1, -45, 52, 35, 26, -19, 4, 17, 4, -7, 37, -18, 30, -67, 53, -16, -30, -63, -58, -14, -10, -39, 15, 14, 58, -4, 30, 22, -69, 20, 15, 41, 34, 71, 38, 33, 58, 54, -52, 12, 51, -30, -69, -38, -44, -19, 58, 42, -48, 20, 59, 40, -34, 36, 68, -72, 42, -68, -61, 27, 71, -29, 43, -45, 72, -31, -52, 65, 69, -61, 30, 25, -23, 55, 32, 10, -32, -3, -12, -54, -1, -16, 17, 22, -55, -16, 69, 35, -17, 47, -18, 26, -53, 50, -24, 7, -54, 41, 8, -67, -9, -37, -9, -59, -66, -10, -35, 61, 33, 57, -2, -38, -39, 23, -29, 31, -62, 55, -5, -54, 22, -13, 53, -31, 34, -5, 37, -70, -52, -36, -12, 47, -22, -34, -55, 9, 19, 64, 73, -59, -24, 61, -27, 44, 39, 64, -1, -63, -70, 53, -61, 59, -22, -44, -25, -53, -7, 73, 30, 29, 25, 72, 69, -59, 44, -60, 49, 16, 42, -54, 17, 10, -63, 28, -51, -31, 53, -52, -51, -32, -4, 36, 57, -41, -14, -6, 58, -58, 55, 45, 54, -25, -67, -65, 18, -35, -6, 20, 41, -50, 6, -5, 36, 15, -68, -66, 17, -1, -71, 67, -3, 13, -71, -68, 60, -24, -50, -28, -1, -42, 60, 35, -64, -61, -24, -49, -4, -2, 55, 21, 50, 49, 62, 32, -53, -49, -41, -22, -66, -24, -52, 63, -22, 41, 49, -2, 49, -2, 60, 55, 32, -39, 59, 47, 45, 72, -45, -61, 25, 30, 22, 74, 42, -21, -51, -71, 73, 39, 40, 58, -23, 46, 48, 22, -30, 17, -17, -42, -3, -23, -49, -54, -54, 68, -44, -15, -18, -64, -1, -63, -73, -67, -36, -15, -3, -71, -36, 73, 18, -61, 35, -14, 14, 34, -60, -2, 5, -33, -73, -45, 71, 42, 47, 25, -71, 59, -19, -39, 72, -25, 43, 66, 51, 45, -59, 51, 32, 22, -53, 22, -51, -56, 40, 3, 15, 48, 36, -17, 49, 49, -70, 54, -45, -68, 63, -5, 16, 69, -9, 29, -51, 2, 4, -8, -39, -73, -41, -69, -23, 73, 17, -12, -57, -53, -13, -41, -25, -72, -5, -63, 32, 63, -44, -11, -23, -12, 16, -40, -48, -70, 63, -65, 10, -60, -40, 44, 18, -33, -33, 24, -8, -37, 23, -51, -25, -67, -66, 39, -45, -44, 72, 70, -18, -2, 38, 0, -58, 63, 11, -18, -4, -47, -28, -48, 61, -41, -50, -15, -62, 4, 33, 46, -45, -50, 63, 29, 49, -24, -17, -31, 24, 19, -59, 53, -32, -55, 54, 7, 34, -31, 68, 7, -73, -20, -68, -71, -36, 8, 34, 28, -19, 53, 2, -13, 11, -6, 6, -73, -51, 15, -50, -34, 43, 23, 21, -23, -21, 18, 14, -56, 17, -5, -14, -60, -55, 28, 42, 18, -24, 9, -10, -56, 71, -53, 8, 38, -53, -49, 7, -49, -46, 40, -38, 57, -68, 52, 46, -56, 72, -7, -56, 32, -61, -56, 40, 38, 41, 65, -22, -42, -36, -64, 51, -58, 21, 12, -27, -39, 2, -68, 56, -17, -54, -39, 70, -67, -64, 4, -58, -2, 70, 58, 20, -25, -62, -42, 45, -21, 59, -31, -42, 63, 22, -56, -30, -40, 16, 31, 20, 7, -28, 60, -59, -64, 7, -8, -56, -30, 67, -11, -15, 43, 40, -27, 47, 27, -62, -52, 18, -50, -25, 53, 49, 52, 40, -24, 73, 40, -49, 2, -19, 41, -61, -7, -39, 9, -36, 41, 36, 61, -35, 50, -60, 27, -25, -24, 34, 2, -29, 29, 30, 58, -64, -39, -70, 7, -60, 44, -53, 19, 48, -4, 15, -24, 35, 34, -13, 64, -49, -57, 59, -52, -50, -22, 18, -48, -34, 66, 71, 18, 67, -51, -29, -64, 0, 38, -17, 38, -63, -1, -40, 68, -66, -52, 30, 20, 72, -1, -8, -2, -9, -47, -44, 68, -44, 32, -25, -57, 45, -8, -43, 18, 40, 4, -53, 41, -8, -74, -41, 59, -43, 60, 7, -60, 71, -70, -46, 44, 62, -25, -68, -37, -41, -27, -23, -64, -69, 40, -61, -37, 35, 11, 31, -31, -26, -3, 37, 65, -57, 50, 50, -16, 73, 59, -25, 69, 35, -12, 35, 50, -9, -32, 7, -21, -73, -60, 18, -20, -5, -65, 55, -36, -16, -71, 38, 39, -48, -37, -51, 29, -69, 34, -52, -42, 1, -46, 1, 33, 55, 37, 24, 64, 40, 73, -24, 62, 59, -27, 20, -21}

#define CONV2D_KERNEL_0_SHIFT (9)

#define CONV2D_BIAS_0 {-10, 108, 43, -66, 83, 61, -8, 64, 4, -71, 98, -34, 57, 84, 106, 2}

#define CONV2D_BIAS_0_SHIFT (8)


/* output enconding for each layer */
#define INPUT_1_OUTPUT_SHIFT 7
#define CONV2D_OUTPUT_SHIFT 6

/* bias shift and output shift for each layer */
#define CONV2D_OUTPUT_RSHIFT (INPUT_1_OUTPUT_SHIFT+CONV2D_KERNEL_0_SHIFT-CONV2D_OUTPUT_SHIFT)
#define CONV2D_BIAS_LSHIFT   (INPUT_1_OUTPUT_SHIFT+CONV2D_KERNEL_0_SHIFT-CONV2D_BIAS_0_SHIFT)
#if CONV2D_OUTPUT_RSHIFT < 0
#error CONV2D_OUTPUT_RSHIFT must be bigger than 0
#endif
#if CONV2D_BIAS_LSHIFT < 0
#error CONV2D_BIAS_LSHIFT must be bigger than 0
#endif

/* weights for each layer */
static const int8_t conv2d_weights[] = CONV2D_KERNEL_0;
static const nnom_weight_t conv2d_w = { (const void*)conv2d_weights, CONV2D_OUTPUT_RSHIFT};
static const int8_t conv2d_bias[] = CONV2D_BIAS_0;
static const nnom_bias_t conv2d_b = { (const void*)conv2d_bias, CONV2D_BIAS_LSHIFT};

/* nnom model */
static int8_t nnom_input_data[1024];
static int8_t nnom_output_data[1024];
static nnom_model_t* nnom_model_create(void)
{
	static nnom_model_t model;
	nnom_layer_t* layer[3];

	new_model(&model);

	layer[0] = Input(shape(8, 8, 16), nnom_input_data);
	layer[1] = model.hook(Conv2D(16, kernel(3, 3), stride(1, 1), dilation(1, 1), PADDING_SAME, &conv2d_w, &conv2d_b), layer[0]);
	layer[2] = model.hook(Output(shape(8, 8, 16), nnom_output_data), layer[1]);
	model_compile(&model, layer[0], layer[2]);
	return &model;
}
