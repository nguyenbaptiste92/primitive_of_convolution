#include "nnom.h"

#define GROUP_CONV2D_KERNEL_0 {-35, 0, -8, 8, -17, -36, -49, -8, 38, 12, 17, 42, -23, 43, 40, 23, 44, 64, 34, -36, 42, -6, 42, -41, 38, -60, 60, 57, 4, 6, -55, 23, 46, -22, -46, 3, 20, 48, -19, 1, 53, 58, -45, 4, -13, 28, 34, 4, 25, -33, -54, 1, -51, 34, -36, 61, 41, 34, 1, -41, -33, -43, -8, 7, -33, 41, 41, -2, 61, 59, 15, 26, 25, 30, 32, 3, -35, 34, 55, -1, -35, 63, 55, -38, -34, -54, -26, -58, -8, -62, -23, 46, -13, -49, -7, 54, -56, -39, 60, -25, -2, 16, 49, -57, -33, -42, -9, -36, -40, -31, -40, 5, 29, 54, 17, 21, 8, 20, -7, -3, 15, 34, 20, -65, 5, -25, -1, -47, -11, -12, -63, 2, -40, 24, 1, -36, 42, -5, 11, -7, -34, -44, 0, -12, 22, -54, -44, 29, 52, 2, 3, -44, -47, 8, -21, 56, 52, 32, -3, -13, -44, -29, 64, 46, -52, -37, 13, 6, -64, 66, -18, -4, 42, 5, -31, 63, -43, 58, -42, -61, 46, -50, -43, 57, 6, -60, -57, 17, 63, -17, -33, 56, -43, 36, -18, 32, 56, 46, -31, -65, 60, -27, -37, -41, 46, 35, 10, 8, -30, -34, 40, -55, -53, 32, -58, -1, -43, 26, -28, 32, -56, 62, 26, -22, -18, 27, -60, -5, 58, 42, 16, 12, -53, 56, 21, 19, -32, -4, 46, -46, -41, 52, 37, 19, -13, 13, -3, -28, -26, 28, 46, -14, 9, 36, 62, -43, 13, -27, -8, 4, 18, 26, -36, -24, 50, 11, -30, -30, -45, -47, 6, 20, -26, 17, 42, -3, 45, -12, 63, 27, 9, -4, -34, -45, -47, -47, 55, 55, 58, -47, -6, -4, -36, 51, 33, 6, 22, 36, 36, -16, 23, 49, -26, -58, -63, -39, 14, -28, 3, 48, 33, 2, 8, 41, 8, -7, -24, -46, -29, -57, -28, 61, 26, 53, -25, -30, -65, -12, -20, 62, 10, -10, 29, -51, 22, -15, -18, -26, -45, 39, 46, 30, 37, -21, -51, -23, -50, -45, -16, -60, -65, -61, 46, 53, -3, -46, -10, 23, -48, -1, 53, 57, 31, -19, -24, 3, 27, -7, -43, -32, 11, -3, 43, 35, 1, -58, -31, -32, -56, -3, -3, -18, 15, 33, -3, -47, -17, -24, -12, 5, 11, 40, 60, 15, 27, -22, -24, 10, 40, 0, 13, -59, 55, 1, 56, -66, -58, 49, -43, 2, 36, -8, 61, 54, 18, -41, -11, -45, -2, 16, 22, -2, 20, 3, 49, 32, 60, -66, -14, 66, 60, -47, -41, -32, 12, -12, -48, -9, 15, 10, -27, -14, -17, 40, -14, -31, 48, -3, 54, -48, 23, -1, -18, -60, 23, 3, -7, -48, 2, 49, -48, -5, -5, 48, -35, -12, 49, -50, 13, 14, -65, -54, -22, 32, -14, 20, 63, 15, 8, 46, -4, -9, -22, 22, -66, -12, -40, 65, 57, -34, -9, -54, 66, 16, 43, 8, -7, -44, 45, -36, 60, -19, -11, 23, 46, -23, -34, 7, 26, 29, -14, 55, 59, -6, -13, 37, 50, 29, 46, -10, -12, 43, -21, -2, -7, 33, -50, 27, 26, 53, -31, -31, -9, 6, -14, 9, -18, 60, 22, 39, -25, 36, -30, -33, 45, 12, 0, 49, -65, -43, 9, -15, -9, -40, 33, -40, -34, -12, 32, 7, -45, -51, 38, -7, 6, -18, 17, -12, 39, 36, -29, 6, 62, -46, 38, -34, 53, -9, 65, -27, 37, -33, 11, 20, -8, -52, 26, -7, -38, -23, 26, -18, -33, -61, -45, 54, 35, -24, 64, 22, 21, -30, -12, 11, -43, 57, -27, -1, 20, 11, 13, -21, 38, -6, 33, 41, 35, -41, -49, 62, 30, 24, 40, 41, 22, -45, 40, -17, -26, -5, 48, 65, -63, -22, 38, -65, 31, -58, -28, 32, 65, 23, -31, -17, 42, 18, 25, -50, 28, 23, 21, 65, 60, -51, -63, 39, -35, -20, 36, 40, 11, 61, 22, 0, 57, -35, 34, -58, -36, -26, -34, 60, 45, 19, -56, -11, 16, 61, -45, -60, 56, -43, -30, -47, 0, 66, 20, 63, 61, 37, 44, 64, -56, -10, 46, 30, 26, -50, -28, 52, 46, -30, -16, 41, -44, -16, -11, -65, -46, -39, -54, -16, 31, 43, -20, 24, -27, 41, -25, -19, -22, 15, -25, -60, 50, 29, 36, -44, -11, -62, 29, -30, 32, -62, 4, 10, 46, -40, -44, -53, 32, 53, -56, -18, -25, 40, 1, -28, 22, 9, 32, 29, 16, -58, 7, 13, 23, 17, 37, -51, 41, -1, 45, 23, 30, -9, -32, -51, -7, 28, 26, 14, -2, -6, -65, 64, -29, -11, -24, -62, -56, -31, -63, -46, 36, 30, -25, 37, 23, -55, 32, -21, -43, -54, -41, -11, -9, -56, 64, -6, 35, -58, -66, 5, -17, 33, -60, 35, -15, -49, -17, -9, 52, 13, -25, 10, 62, 35, 65, 52, 40, 24, 54, 10, -43, 8, -49, 15, -28, -52, 41, 31, -12, -36, -47, 32, 1, -10, -46, 3, 32, 42, 27, 42, 31, 45, 65, -3, 10, 34, 41, -20, 34, -48, 47, -60, 27, -39, -51, 0, -54, -54, -18, 48, -59, 55, -61, 36, 50, -47, 49, 25, 34, 30, 65, 17, -42, 15, -17, -5, -44, -58, 38, -10, 33, 62, 59, -47, 44, 16, 18, 28, 14, 4, 32, 30, 43, -56, 41, 31, 48, 45, 12, -1, 44, 43, -62, -18, 35, -6, -1, 59, -62, 2, 45, -7, -54, -55, 27, -52, -63, -3, 57, -33, -48, -44, -44, -14, 11, 47, -12, -43, -24, 31, -66, -6, -41, 9, -33, 42, 59, -30, 41, -17, 61, -25, 16, -31, 2, 65, -44, -65, 23, -8, -37, -26, -57, -18, 62, 12, 59, -6, -41, 4, 28, 18, 65, -6, -59, -48, -49, 54, 15, 41, -34, 4, 15, -49, 5, 47, 43, 63, 48, 6, -37, -48, -27, -4, 64, -23, 31, -25, 43, -42, 48, 5, -14, 39, -23, 27, -18, 28, -11, 10, 23, -50, -14, -11, 10, -61, 13, 42, 16, 7, -54, -38, -44, 17, 8, -52, -65, -44, 53, 44, -11, 36, 5, 25, 51, -40, -11, 61, -48, -21, -7, 4, -60, -21, -16, -27, 51, -25, -7, -59, -44, 14, -38, 61, -23, -58, -41, 28, -22, 58, 4, 62, 51, 19, -29, 0, 65, -47, 55, 3, 18, -33, 37, 36, -22, 40, 48, 30, -32, 20, 16, -18, -9, 0, -11, -57, 5, 50, 11, -52, 4, -27, -41, -66, 31, -52, 53, -4, -61, -12, 59, -52, -53, -26, -8, 44, 27, -44, 28, -64, -22, 53, 55, -38, -19, 2, 44, 10, 33, -1, 34, 66, -9, -8, -61, 24, 9, 4, -7, -46, 60, -63, -8, -45, -54, -41, 41, 65, 49, -36, 12, -27, -44, 58, -61, 36, -35, 59, -17, -6, -58, 13, 35, -23, -19, -35, -1, 56, -36, -22, -18, -44, 55, -40, -24, 60, -34, 38, 33, 58, 63, 63, -16, -26, -31, -38, -41, 62, 57, -44, 42, -40, -48, 3, 57, -32, 20, -17, 64, 44, -14, 40, -49, 60, -24, 52, 14, 46, 59, -13, -25, -50, 27, 38, 17, -5, -45, 64, -5, -38, 21, -50, -35, 15, -26, 50, -49, 32, -25, -25, 33, -24, 15, 34, -30, -44, -10, 58, 63, -7, -13, -51, -6, -7, -18, -31, 6, -11, 42, 31, 32, -16, 48, 28, -28, -62, 39, 22, -64, 63, 47, 6, -1, 30, 18, -36, 34, 23, 4, -36, -40, 8, 43, -35, -15, 13, -38, -42, 64, -23, -16, 28, -47, -41, -39, 38, -47, 13, 29, -12, -50, -65, 36, 28, -37, -31, 13, -47, 19, 0, 43, -28, -18, -36, -29, -23, 22, -57, 27, -40, 53, -60, 4, -8, -9, 45, -5, 46, -5, -34, -28, 15, 25, 2, -3, 0, -56, 26, -63, 4, 32, 9, 36, -13, 39, 41, -49, -63, 4, 41, -37, 48, 1, 23, -34, 7, -37, -17, 25, -30, -35, -34, -2, 22, 39, -59, -65, 34, -44, -52, 36, 64, -30, -57, -60, 64, 65, 30, 36, -44, -11, -16, 11, -47, 7, 34, 14, -51, 3, -54, 49, -27, 32, -36, 38, 4, -44, 26, -39, 11, -62, 2, 66, -42, 2, -2, 45, -33, -52, -41, -14, -9, 32, 7, -1, 10, -7, 49, -56, -34, -36, 55, 45, 66, -45, 9, -34, 23, -43, 19, 36, -52, 7, -19, 35, -62, -58, -45, 66, 48, 49, 29, -50, 8, -25, -22, 22, 42, -52, -7, -27, -11, -37, 27, -35, -1, 30, 38, 20, 26, -59, -12, 43, 41, 4, -56, 28, -29, -33, 4, -49, -37, 26, 13, -21, -24, -61, -53, -14, -53, 55, -30, 50, 25, -24, 55, 12, -22, 25, -23, 56, -34, 50, -28, 1, 42, -29, -63, 59, -1, 58, -62, 51, -52, -63, -12, -29, 39, 16, 21, 60, 50, -53, 28, 17, -45, -9, 47, -7, -7, 56, 8, -3, 9, 25, -9, -63, -3, -45, 53, -62, 63, 0, -66, 63, -13, 47, -40, -40, -8, 14, -41, -30, -8, 34, 40, -56, -51, -10, 44, 32, -3, -59, -18, 53, 18, -46, -41, -26, 23, 30, -6, 37, -29, -12, 21, -44, 8, -3, -9, -57, 47, -19, -17, 43, 45, 37, -35, -24, -49, -55, 4, 61, -53, -38, -11, 48, 26, -26, -20, 30, -43, -60, 42, 18, -3, 48, 35, 33, 15, -34, -66, -28, -19, -1, -14, 5, -19, -64, 41, -46, 65, -22, -20, 53, 43, -49, 15, 51, -24, 26, -23, -37, -51, -30, -19, 47, -16, 52, -13, 0, 17, -59, -26, -8, -7, 2, -7, -35, -61, -5, 16, -34, -32, 12, -41, -30, -13, -51, 59, 47, -41, 7, -46, -38, -56, 29, -8, 46, -64, -51, -7, 13, -29, -31, 47, 38, -29, -8, -3, 64, -37, 6, 60, -9, 9, -48, -50, 31, -23, -38, -60, -56, -50, 13, -42, -53, 46, -56, 55, 50, 58, -14, -7, 9, -22, 37, 45, 11, -35, 61, 34, -5, -24, -64, 38, -40, -42, 0, 54, -19, 10, 24, -31, 50, 6, 65, 40, 3, -50, -11, 55, -5, 23, -43, -35, -5, -20, -2, 24, -45, 11, 1, -42, 61, 0, -31, -36, 43, 26, -39, -2, -39, -9, -65, -3, 66, -54, 9, -55, 64, 3, -55, -48, -61, -63, 38, -2, 53, 0, -5, 41, 6, 40, 18, 61, 14, 30, 37, -1, -8, -53, -31, -24, 35, 43, -39, -50, -54, -30, -60, 64, 51, -13, -34, 50, 25, 58, -27, 22, 65, 33, -61, -18, 54, -2, -12, 47, -43, 3, 15, -53, -11, -37, -3, -40, 39, -29, -26, -8, 55, 47, -24, 37, -11, 65, 35, 29, 43, 9, -31, -60, 10, 19, 4, 60, -19, -3, -51, 46, -23, -42, -1, -16, -51, -58, -47, 65, 31, 48, -11, -25, 21, 45, -65, -47, 32, -10, 53, 56, -21, -2, -48, -60, 36, 23, 4, 29, 59, -59, -37, -20, -32, -25, -37, -58, 5, 32, 20, 45, -34, 35, -24, 22, -62, -62, 0, -24, 9, -39, -20, 16, 55, 51, 22, -9, -48, -1, 3, 48, -28, 52, 14, 63, -62, -61, -57, -66, 34, 39, -62, -15, -17, -40, -54, 64, 7, -3, 11, -57, 38, 23, -40, -65, -59, 52, 1, -19, 23, 43, 26, -58, 10, 42, 10, -35, 58, 60, -26, -9, 29, 20, 32, -42, 45, -62, -46, -63, -65, -45, -60, 23, -41, 54, -14, -36, 58, -63, 49, -4, -46, -50, -43, -26, -46, 9, 14, -53, -22, -30, 60, 11, 38, 23, 15, -39, 57, -46, -45, -33, -19, -1, -10, 9, -51, 19, -24, -31, -60, -2, 37, 46, -49, 18, 3, -63, 29, 42, 9, 59, 62, -45, -62, -15, -4, -27, 38, 12, 32, -35, 62, 23, 42, -23, 38, -10, 25, -44, -5, 63, 18, 48, -6, -61, 45, 11, 37, -17, -32, 10, 29, -16, -21, -58, -38, -23, 29, -55, -10, -37, -16, -6, 59, -37, -29, 5, -9, 42, 31, -57, -4, 58, -47, -16, 59, 28, -66, -50, 60, 6, -21, -14, 41, -50, -9, 19, -63, -39, 6, 28, 57, 28, 58, -7, -62, 36, 61, 54, -25, -9, 18, 13, -62, 7, -49, 7, 9, -32, 50, 46, -3, -39, 1, 41, 52, -4, -27, -52, 13, -21, -36, 41, -34, -2, 23, 49, 21, -55, -11, 19, 6, 62, -2, 50, -34, -23, 57, -7, -52, 8, 27, -31, -17, -48, -41, -59, -65, -5, 32, 29, -39, -54, 27, 33, 36, 52, 38, 37, 26, 8, -43, 22, -47, 30, -3, 52, -7, 24, -26, 46, -59, 7, 29, 50, -6, 21, 46, -58, -41, -25, -50, -9, -64, 43, -62, 25, 64, 11, 36, 63, 43, 36, 38, 60, -61, 36, 9, -53, -57, 57, 38, -44, -34, 20, -57, -47, 40, 16, -36, -28, 19, -38, -43, -4, 27, -12, -55, -18, 22, -46, 2, 17, 28, 43, 50, 48, 47, -49, -58, 16, 15, 16, -62, 50, 24, -9, -41, -41, 28, 49, -32, -56, -35, 15, -64, -46, 40, -26, -44, 34, 31, 31, -53, -54, -31, -14, 54, 59, 45, -30, 35, 13, 7, -38, -6, 33, -19, 19, 6, -56, 31, -23, 37, 20, 11, 28, 45, -23, -11, -16, 44, -12, -44, -5, -21, 20, 63, 4, 29, -55, 44, -3, 34, -3, -41, 31, -13, 7, 57, -3, 4, -19, 41, -44, -15, -32, -5, 27, -1, -61, 63, 52, 26, 36, 22, 61, -1, -33, 15, 17, -17, 45, 12, 63, 60, 65, -36, 30, -20, 19, -21, 22, -56, -26, -7, 16, -15, -14, 28, 58, -20, 41, -64, -21, 51, -63, -2, 33, 0, 34, -55, -30, 14, 61, -39, -8, -51, 16, -40, 15}

#define GROUP_CONV2D_KERNEL_0_SHIFT (9)

#define GROUP_CONV2D_BIAS_0 {-49, 4, 0, 27, -57, 31, -57, -7, 73, 18, -74, 49, -73, 47, 28, -63, 58, 45, 65, -52, -68, -3, 39, -59, 54, -57, -11, 75, -62, 64, 42, -67}

#define GROUP_CONV2D_BIAS_0_SHIFT (8)


/* output enconding for each layer */
#define INPUT_1_OUTPUT_SHIFT 7
#define GROUP_CONV2D_OUTPUT_SHIFT 6

/* bias shift and output shift for each layer */
#define GROUP_CONV2D_OUTPUT_RSHIFT (INPUT_1_OUTPUT_SHIFT+GROUP_CONV2D_KERNEL_0_SHIFT-GROUP_CONV2D_OUTPUT_SHIFT)
#define GROUP_CONV2D_BIAS_LSHIFT   (INPUT_1_OUTPUT_SHIFT+GROUP_CONV2D_KERNEL_0_SHIFT-GROUP_CONV2D_BIAS_0_SHIFT)
#if GROUP_CONV2D_OUTPUT_RSHIFT < 0
#error GROUP_CONV2D_OUTPUT_RSHIFT must be bigger than 0
#endif
#if GROUP_CONV2D_BIAS_LSHIFT < 0
#error GROUP_CONV2D_BIAS_LSHIFT must be bigger than 0
#endif

/* weights for each layer */
static const int8_t group_conv2d_weights[] = GROUP_CONV2D_KERNEL_0;
static const nnom_weight_t group_conv2d_w = { (const void*)group_conv2d_weights, GROUP_CONV2D_OUTPUT_RSHIFT};
static const int8_t group_conv2d_bias[] = GROUP_CONV2D_BIAS_0;
static const nnom_bias_t group_conv2d_b = { (const void*)group_conv2d_bias, GROUP_CONV2D_BIAS_LSHIFT};

/* nnom model */
static int8_t nnom_input_data[16384];
static int8_t nnom_output_data[32768];
static nnom_model_t* nnom_model_create(void)
{
	static nnom_model_t model;
	nnom_layer_t* layer[3];

	new_model(&model);

	layer[0] = Input(shape(32, 32, 16), nnom_input_data);
	layer[1] = model.hook(GroupConv2D(32, 2, kernel(3, 3), stride(1, 1), dilation(1, 1), PADDING_SAME, &group_conv2d_w, &group_conv2d_b), layer[0]);
	layer[2] = model.hook(Output(shape(32, 32, 32), nnom_output_data), layer[1]);
	model_compile(&model, layer[0], layer[2]);
	return &model;
}
