#include "nnom.h"

#define GROUP_CONV2D_KERNEL_0 {-8, -14, 78, -52, -87, -37, 90, -88, -65, 101, -42, 64, 51, 38, -8, 57, 83, 4, 56, -94, 30, -21, 11, 74, 97, 8, -84, -3, -20, 85, -88, -34, -77, 62, -2, -75, 97, 8, -28, 98, -43, -100, 88, 89, 72, -95, 90, -6, 21, 82, -100, 68, 91, -52, -8, -61, 9, -6, 12, -1, -86, 63, -26, -68, 38, 23, 90, -87, -1, -10, -82, 90, 63, 89, 67, -92, 29, -49, 20, -51, -20, -75, -22, 25, 30, -30, -74, 77, 85, -20, 13, 66, 35, 52, 35, 33, 87, 22, -60, -48, 38, -68, -81, 15, 80, 51, -61, 79, 40, 80, -87, 1, -57, 0, 66, 51, 86, 46, 79, 34, 54, 69, -94, -89, -26, 100, 59, 82, 52, -69, -41, -45, 40, 55, -88, 76, -24, -3, -50, 49, 99, -89, 57, -60, -67, -45, -73, -84, -61, -68, 27, -8, 51, 85, 63, 84, -29, -55, 34, -2, 62, 13, -61, 47, 47, -26, 76, -67, -26, -12, -57, -18, -17, 95, 100, 93, -79, -17, -80, 92, -5, 79, 76, -74, -93, -23, -8, -75, 71, -70, -51, 42, -19, 25, 35, -27, -58, -67, -39, -85, 58, -10, -28, 61, -44, -49, 32, 64, 64, -73, 99, 37, 47, -30, -74, 48, -51, 23, 4, 32, -80, 3, 52, 29, 24, 75, -10, -9, -67, 57, -56, 31, 75, -53, 41, 82, 61, -5, -61, 62, -69, -99, -84, -69, 43, 60, -94, 84, -23, 39, -28, -42, 73, -11, -1, 71, 48, 79, -62, -92, 92, -61, -13, 74, -13, 53, 5, -67, 51, -71, -73, 71, -84, 27, -16, 32, 93, -89, -63, 53, -52, -73, 3, 34, 43, -76, 36, -95, 18, -75, 80, 94, -12, -57, -26, 79, -27, -6, 25, -90, -68, 92, 91, -26, -12, 25, -56, -11, 62, 73, -91, -38, -40, -5, -73, -89, 96, -15, 71, -15, -94, -26, -64, 10, 5, 15, 57, 16, 81, 84, 31, -100, 29, 35, -59, -51, 64, 86, -2, -97, 26, 35, 18, -99, -69, 19, 54, -4, -36, 100, 55, 43, 56, 73, 0, -52, -21, -49, 18, 37, -57, -61, 88, -54, -1, 7, -45, -54, -72, 4, 36, -42, -71, 47, -30, 77, 60, -56, -30, 7, -67, -68, -36, -30, -64, -34, 98, -64, -84, 66, 95, 19, 88, -84, 77, 34, -77, -51, 59, 84, 69, 19, -84, -90, 53, -48, 38, -29, 75, 40, 33, 37, 68, -7, -25, -4, 48, -4, -29, -18, 88, -75, -41, 88, -3, -42, 13, -20, -65, -84, -62, -19, 28, -86, -3, 24, -52, 84, -24, 67, -25, 27, -60, 4, 13, -19, 41, -37, -75, 45, 6, 37, 35, -73, 58, -66, -24, -67, -49, 82, -85, -3, -77, -86, -19, -39, 46, 62, 48, 50, 80, 64, -97, 68, 68, -77, -32, -70, -88, 90, -93, 77, -68, 74, 16, 2, -46, -15, 48, -24, 87, 7, -8, -90, 17, -92, -80, 24, -8, -100, 91, -93, -78, 58, 13, 12, -19, -96, -65, 14, 21, 16, 83, -72, -8, -87, 82, 48, 64, -12, -13, 79, 31, -70, 13, 36, -3, 29, 40, 32, -34, 33, -25, -68, -69, -62, 81, -6, 3, -5, 82, 18, -92, -14, -93, 101, -84, 41, -100, -68, -62, -42, 79, -68, -100, 39, 7, -94, 75, -40, 3, -81, -25, -86, -7, -74, -1, 51, 54, -100, -62, -69, 40, 57, -28, -92, -60, 30, 33, 36, 38, -80, 13, -4, 27, 82, 39, -72, -50, 14, -6, 25, 67, -28, 87, -37, -54, -39, -82, -4, 26, -97, -24, -56, -71, 8, -91, 55, 41, -67, 46, -59, 95, 36, -66, 36, 16, 17, 48, -4, 26, -49, 11, -99, 87, 35, 62, 4, 57, -97, 91, -99, -76, 53, 2, 14, -47, 34, 75, -23, 19, 5, 91, -29, -58, 101, 43, -69, 16, 68, -42, -95, 21, -3, 8, 101, -87, -57, 93, 38, 20, 45, -11, -10, 11, 34, -50, -9, -66, -65, 60, 54, 69, 25, -23, -87, 83, -73, -43, -6, -88, 94, 17, 76, 90, 7, 100, 68, -95, -91, -34, -95, -85, -47, 87, -48, 58, -8, 22, 23, 33, 61, 51, -63, -101, 89, 8, -79, 10, -17, -25, -73, -44, 56, -7, 26, 46, 82, -50, 73, -54, -2, 79, 62, 73, 2, 68, 27, 29, -45, -31, 87, -12, 72, -97, -63, 42, -17, -85, 17, -51, -19, 50, -52, 54, 2, 79, -33, 50, -42, -94, 44, -76, 85, 26, -12, -84, 93, 5, 31, 30, 74, 88, 83, 21, -72, 87, -22, -100, -98, 70, -50, 52, -11, 77, 49, -39, -73, -16, -18, -79, -43, -87, -94, 34, 76, 89, 26, -54, 99, 28, -67, 58, -68, 55, -17, -26, -93, 33, -20, 38, 100, 84, 30, 100, -91, -43, 86, 86, -95, 24, 97, -1, -15, -6, 37, -3, -22, 18, -90, 91, 80, -35, -75, -31, 5, 85, -77, -89, 62, -49, 28, 93, -55, -1, 28, -31, 7, -13, 27, 20, -69, -82, -12, -71, -83, -98, -78, -82, 6, -58, 50, -77, 85, 37, 49, 40, 56, 32, 19, -93, 63, -38, -34, 52, 26, -6, 73, -70, 11, 22, -44, 9, -86, 83, 70, 50, -32, 96, -8, 6, 45, -58, 73, -15, 41, -80, -76, 35, 48, 85, 51, 63, -91, -14, 5, 37, 61, -73, -2, 65, -84, 84, 90, -57, -8, -82, 61, -100, 32, 76, -12, 37, 84, 59, 8, -63, 25, 0, -92, 35, 68, 62, 45, -92, 19, -29, -61, -51, 99, -41, 19, -47, 21, 24, 36, -7, 6, -6, 44, -78, 37, 56, 84, 87, 2, -1, -63, -11, 31, 11, -71, -12, 70, -37, 14, 17, 97, 34, 88, -46, -67, 38, 47, 31, 73, -100, 13, 87, 18, 6, -54, 11, 60, 59, 42, -55, 18, 56, 8, 54, -55, 93, -66, 4, 35, 11, -32, -94, 75, 58, 84, -53, 44, 1, 62, -96, -34, 81, 14, -71, -84, 46, 3, 30, 0, 71, 70, -81, 82, -56, 31, -44, 0, 30, 62, 47, 53, -12, -21, -97, 21, 36, -45, -83, 87, -63, -78, 101, 80, -89, 32, -57, 17, 45, 42, 11, -6, 22, 37, -15, -39, -33, 89, 8, 84, -82, -39, -22, -98, -66, -68, -4, -46, -85, 41, -89, 13, 1, 66, 69, -97, -44, 76, 5, 61, 13, 48, -37, -17, 43, -88, -36, 68, 85, -13, 12, 66, 30, -99, 25, 84, 74, -64, 53, 43, 61, -45, 33, 97, -39, -31, -33, 89, -46, 5, 95, -4, 27, -94, 94, 2, 48, 57, 81, -5, -67, -97, 88, 7, -87, -53, 85, -70, 88, 4, 78, 38, -95, 68, 32, 95, 14, -42, -60, -21, -57, 48, -69, -85, -93, -42, 73, 13, -12, -8, -80, 62, -36, -80, -64, 23, 9, 2, -58, -74, 68, 25, -93, 31, -32, 56, 96, 45, 59, 98, 98, 32, 84, 59, 43, 90, -12, 97, -49, -30, 32, -7, 37, -24, 32, -80, -94, -53, 68, 50, -40, 54, 69, 3, -35, 14, -7, -12, -11, -38, 7, 45, -54, -78, -84, 39, -58, 23, 71, 30, -36, -97, 24, -63, 95, 23, -42, 65, -63, -55, 64, -93, -57, 89, -45, -17, -33, 44, 14, 74, -98, -101, -49, 49, -28, 35, -3, -94, 90, -7, -12, 77, -5, -10, -6, -83, 3, -100, -76, 20, -80, 33, 88, 25, 20, -96, -35, -44, 38, -83, 83, 80, -49, 2, 100, -75, -65, 18, 70, -19, -95, -6, -85, -20, -62, -81, -66, 47, -21, -75, 63, -81, 72, 21, 27, -48, -101, 46, -8, 78, -51, -91, -27, 57, 79, 49, 19, 77, 79, -79, 62, -77, -79, 69, 67, -85, -63, -3, -54, 49, 0, 85, -21, -2, -77, 17, 36, -5, -99, -3, 74, -15, -48, -20, -10, 77, 14, -18, -7, 27, -63, -16, 2, 9, 84, -27, -4, -6, -99, -24, -28, -36, -58, 76, -65, 27, -24, 21, -58, -26, -12, 43, -8, -64, -84, 79, 56, 101, 5, -27, -22, 47, -96, 54, -6, -6, -29, 94, 30, 86, 92, -17, -49, -96, 32, -38, 21, 91, -44, 92, -88, 38, 47, -52, -77, -52, 75, -74, 9, -75, -23, -94, 59, -30, -16, 68, 6, 10, 72, -43, 80, 59, 59, -70, -32, 87, -83, -35, -70, -24, -60, -12, -91, 83, -88, -82, 61, -46, -34, 19, -83, 98, 77, 89, -84, -72, -92, 26, 89, -66, 14, 4, -76, 83, -72, 36, -83, -98, -85, 41, -78, -73, 87, -71, 87, -3, -4, 73, 99, 48, 55, 92, -41, 78, 20, -85, 90, 67, -58, 33, 16, 12, 29, 9, -50, -89, -29, -21, -88, 37, -40, 23, 98, -13, 67, -43, 24, 62, -75, -12, 53, -5, 17, 90, -21, -9, 76, -33, -74, -74, 22, 89, 28, -82, 81, 64, -78, -16, -16, 23, -58, 29, 85, -70, -6, -76, 9, 69, -79, -49, 66, 74, 19, -86, 19, 2, 88, -39, 43, 21, -8, -83, 30, -19, -34, 22, -87, 92, 41, -28, 96, 93, 76, -81, 86, 44, 58, 43, 64, 97, -59, 9, 6, -2, -1, 94, 87, -36, 53, 47, -66, -57, -90, -15, 38, 10, 1, -36, 56, -82, -14, -66, -37, -12, 62, -82, -31, 66, 73, 17, -18, 8, -37, 96, -8, 32, 15, -10, -77, -66, 54, 10, -1, 59, -2, -84, -94, 81, -28, 68, -73, -12, 97, -34, 19, 26, 19, -39, 46, 99, -10, 48, 38, -83, 57, -45, -90, 49, 88, 55, -84, -16, -40, -40, -54, -87, 2, 43, 20, -55, 53, 43, 8, 5, -31, -86, 30, 46, 89, -71, -59, -85, -37, -25, -33, 77, 25, 32, -57, 89, 19, -42, -77, 97, -57, 76, 20, 82, 41, 77, 89, 41, -27, -31, -64, -96, 10, 74, 96, 2, 89, -43, 49, -48, 23, -16, 44, -4, -55, 22, -62, 46, 84, -4, -90, 83, -54, 24, 31, -60, 81, 73, -10, -38, -23, 46, -47, -4, -64, 55, 33, -25, 21, -41, 43, 68, -66, -68, 40, 90, 43, 3, -35, 101, 74, -99, -51, -83, 7, 73, -13, 93, -50, -79, -85, 89, -83, 46, 4, 45, 19, -66, 48, -95, -3, 26, 33, -60, 95, 81, -22, 62, 47, 86, 16, 5, -32, -1, 36, -63, -84, 8, -59, 17, -20, 32, 29, -7, -81, 58, -11, -13, -45, 86, 49, 101, -69, 13, 64, -1, -59, -70, 9, 17, 17, -83, -5, -25, 56, -66, -92, -72, -71, -29, 8, -79, -81, -19, 100, 91, 55, -57, 87, -90, 88, 79, 87, 59, -78, 58, -23, 10, -31, -68, -21, 91, 68, 5, -68, 88, -75, -90, 7, -98, -64, -88, 36, -21, -83, 81, -17, -56, 60, -6, -39, -94, 49, -58, 18, 7, 59, 33, -90, -98, 85, -43, 28, -35, -73, 60, -87, 30, -23, 18, -25, -21, 76, -100, 34, 46, 47, 56, 73, -69, 36, -59, 97, -76, -84, 69, 56, -59, 97, -60, 18, 42, -36, 9, -22, -48, -63, -52, 90, -85, 100, 69, -5, 53, 16, 15, -42, -20, 94, 50, 68, -19, 10, 31, 20, 99, -24, 98, -10, 50, -89, -21, 30, -79, -37, -85, 79, -35, 100, -66, 39, -85, -3, -5, -57, -11, -80, 71, 18, -36, 62, 93, 18, 42, 49, 93, 88, -97, 90, -6, 13, 32, 71, -3, 43, 79, 44, -18, -12, -64, -42, 45, 38, 22, -20, -82, -7, 100, -100, 56, 36, 6, 37, -56, 94, 22, -87, -80, 20, -32, 29, 31, -22, -50, -77, 47, -9, 68, 15, 38, 10, -29, -6, 31, -31, 54, -84, 68, -38, 28, -3, 67, 52, 53, -18, -42, 74, 28, 27, 17, -29, 97, -86, 22, 20, 83, -52, 23, -72, 12, 26, -4, 11, 49, -24, 67, -21, 85, 79, -26, 10, -43, 3, 45, 63, -91, 13, 3, -35, -34, -35, -65, -59, -13, 52, 74, 57, -87, 38, -63, -56, 90, -35, 4, -99, -34, -97, 26, -93, -6, 80, 9, -3, -29, 47, -36, 40, 66, -66, -7, 57, -42, -74, -39, 45, 89, -34, -10, 6, 68, 36, 22, 7, 84, -41, -15, -66, -50, -73, -21, -92, -69, -50, -4, -43, 101, -59, 43, -76, -46, 86, 17, 74, 58, 25, 11, 65, -9, 67, -72, -58, 10, 79, 21, 93, -55, 40, 13, 23, 30, 12, 14, -77, -40, -84, 69, -52, -96, 28, 84, 56, -12, -18, 86, 71, 50, 75, -94, 86, 98, 52, -98, 53, 22, -53, 19, 100, 36, 90, 97, -81, 78, -80, -23, -59, 41, -94, -29, -76, 73, -52, -71, -36, -98, -64, -57, 59, -32, 99, -29, -73, 16, 43, 4, -99, -77, 53, -10, -23, 84, -60, -79, -72, -87, 10, -17, -85, 13, 71, 19, -85, -6, -95, -67, 79, 39, 64, 46, 47, -9, -81, -25, -24, -2, 60, -19, -87, -68, -56, -8, 51, -67, 17, 46, -22, -83, -42, 54, -36, -22, 87, 21, -78, 24, 24, -36, -47, 38, -71, -4, 50, -65, 29, 59, 79, 75, 67, -35, 79, -29, -27, -87, -47, -19, -24, -80, -100, -87, 93, -34, -56, 3, -24, -37, 100, 86, 29, 7, -1, -60, 49, -70, 23, -8, 37, -62, -49, -72, 15, -88, 52, 101, 13, -60, -38, 96, 64, 34, -35, 8, 12, -3, -87, -19, 31, -73, -99, 71, -24, 51, -14, 93, -86, -26, 33, 6, 43, -21, 74, -61, -92, -75, 64, -1, -87, -98, -2, 81, -89, -25, -89, 75, 3, -44, 25, -5, -23, 41, -65, -18, 80, 82, -78, 81, 54, 75, -38, 51, 19, -41, 92, -79, 93, -27, 56, 34, -47, -47, -42, 69, 81, -40, -73, -81, 89, -12, -33, 3, -19, 17, 21, -43, -78, 27}

#define GROUP_CONV2D_KERNEL_0_SHIFT (10)

#define GROUP_CONV2D_BIAS_0 {-68, -66, 62, -80, -93, -43, -3, 27, -16, 86, 93, -45, -81, 106, -102, -73, -66, -92, 90, 73, -29, -64, 73, 12, 60, 8, 105, 26, 100, -86, 44, 21, 3, 23, 58, 22, -97, -95, 66, 46, -89, -25, 16, 1, -75, 17, 94, 44, 47, -23, 102, -20, -87, 3, 105, -106, -3, 95, -53, 48, 29, -4, -42, -41}

#define GROUP_CONV2D_BIAS_0_SHIFT (9)


/* output enconding for each layer */
#define INPUT_1_OUTPUT_SHIFT 7
#define GROUP_CONV2D_OUTPUT_SHIFT 6

/* bias shift and output shift for each layer */
#define GROUP_CONV2D_OUTPUT_RSHIFT (INPUT_1_OUTPUT_SHIFT+GROUP_CONV2D_KERNEL_0_SHIFT-GROUP_CONV2D_OUTPUT_SHIFT)
#define GROUP_CONV2D_BIAS_LSHIFT   (INPUT_1_OUTPUT_SHIFT+GROUP_CONV2D_KERNEL_0_SHIFT-GROUP_CONV2D_BIAS_0_SHIFT)
#if GROUP_CONV2D_OUTPUT_RSHIFT < 0
#error GROUP_CONV2D_OUTPUT_RSHIFT must be bigger than 0
#endif
#if GROUP_CONV2D_BIAS_LSHIFT < 0
#error GROUP_CONV2D_BIAS_LSHIFT must be bigger than 0
#endif

/* weights for each layer */
static const int8_t group_conv2d_weights[] = GROUP_CONV2D_KERNEL_0;
static const nnom_weight_t group_conv2d_w = { (const void*)group_conv2d_weights, GROUP_CONV2D_OUTPUT_RSHIFT};
static const int8_t group_conv2d_bias[] = GROUP_CONV2D_BIAS_0;
static const nnom_bias_t group_conv2d_b = { (const void*)group_conv2d_bias, GROUP_CONV2D_BIAS_LSHIFT};

/* nnom model */
static int8_t nnom_input_data[12800];
static int8_t nnom_output_data[6400];
static nnom_model_t* nnom_model_create(void)
{
	static nnom_model_t model;
	nnom_layer_t* layer[3];

	new_model(&model);

	layer[0] = Input(shape(10, 10, 128), nnom_input_data);
	layer[1] = model.hook(GroupConv2D(64, 32, kernel(3, 3), stride(1, 1), dilation(1, 1), PADDING_SAME, &group_conv2d_w, &group_conv2d_b), layer[0]);
	layer[2] = model.hook(Output(shape(10, 10, 64), nnom_output_data), layer[1]);
	model_compile(&model, layer[0], layer[2]);
	return &model;
}
